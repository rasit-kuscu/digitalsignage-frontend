{"version":3,"file":"modal-backdrop.js","sourceRoot":"","sources":["modal-backdrop.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  ViewEncapsulation,\n  OnDestroy,\n  trigger,\n  state,\n  style,\n  keyframes,\n  animate,\n  transition\n} from '@angular/core';\n\nimport { DialogRef } from '../../angular2-modal';\n\nimport { BSModalContainer } from './modal-container';\nimport { BSModalContext } from './modal-context';\n\nlet dialogRefCount = 0;\n\n/**\n * Represents the modal backdrop.\n */\n@Component({\n  selector: 'modal-backdrop',\n  host: {\n    '[style.position]': 'hs.ps',\n    '[style.height]': 'hs.sz',\n    '[style.width]': 'hs.sz',\n    '[style.top]': 'hs.pt',\n    '[style.left]': 'hs.pt',\n    '[style.right]': 'hs.pt',\n    '[style.bottom]': 'hs.pt'\n  },\n  directives: [BSModalContainer],\n  animations: [\n    trigger('fade', [\n      transition('void => in', [\n        animate('150ms linear', keyframes([\n          style({opacity: 0}),\n          style({opacity: 0.5})\n        ]))\n      ]),\n      state('out',  style({ opacity: 0 } )),\n      transition('* => out', [\n        animate('150ms linear', keyframes([\n          style({opacity: 0.5}),\n          style({opacity: 0.5})\n        ])),\n        animate('150ms linear', keyframes([\n          style({opacity: 0.5}),\n          style({opacity: 0}),\n        ]))\n      ])\n    ])\n  ],\n  encapsulation: ViewEncapsulation.None,\n  template: `<div [style.position]=\"hs.ps\" class=\"modal-backdrop in\" @fade=\"fadeState\"></div>\n<modal-container></modal-container>`\n})\nexport class BSModalBackdrop implements OnDestroy {\n  fadeState: 'in' | 'out' = 'in';\n\n  private hs = {ps: null, sz: null, pt: null};\n\n  constructor(dialog: DialogRef<BSModalContext>) {\n    dialogRefCount++;\n    document.body.classList.add('modal-open');\n\n    if (dialog.inElement) {\n      this.hs.ps = 'absolute';\n      this.hs.sz = '100%';\n      this.hs.pt = '0';\n    }\n\n    dialog.onDestroy.subscribe(() => this.fadeState = 'out');\n  }\n\n  /**\n   * Temp workaround for animation where destruction of the top level component does not\n   * trigger child animations. Solution should be found either in animation module or in design\n   * of the modal component tree.\n   * @returns {Promise<void>}\n   */\n  canDestroy(): Promise<void> {\n    return new Promise<void>(resolve => {\n      setTimeout(() => resolve(), 310);\n    });\n  }\n\n  ngOnDestroy() {\n    if (--dialogRefCount === 0) {\n      document.body.classList.remove('modal-open');\n    }\n  }\n}\n"]}